â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  CHECKLIST KIá»‚M TRA SAU KHI Sá»¬A Lá»–I - 9 THÃNG 12, 2025
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

BÆ¯á»šC 1: RESTART SERVICES (3 phÃºt)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[ ] 1.1. Cháº¡y: .\stop-all-services.ps1
[ ] 1.2. Äá»£i 10 giÃ¢y
[ ] 1.3. Cháº¡y: .\start-all-services.ps1
[ ] 1.4. Äá»£i 2 phÃºt cho services khá»Ÿi Ä‘á»™ng

BÆ¯á»šC 2: CHECK SERVICE HEALTH (1 phÃºt)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[ ] 2.1. Recommend-service: curl http://localhost:8095/actuator/health
        Expected: {"status":"UP"}
        
[ ] 2.2. Python model: curl http://localhost:8000/health
        Expected: {"status":"healthy"}
        
[ ] 2.3. Post-service: curl http://localhost:8094/actuator/health
        Expected: {"status":"UP"}

[ ] 2.4. Check logs khÃ´ng cÃ³ lá»—i Bean Definition:
        docker-compose logs recommend-service | Select-String "BeanDefinition"
        Expected: KhÃ´ng cÃ³ output (hoáº·c chá»‰ cÃ³ "created bean")

BÆ¯á»šC 3: TEST RECOMMENDATION SCORES (2 phÃºt)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[ ] 3.1. Get feed:
        curl "http://localhost:8095/api/recommendations/feed?userId=31ba8a23-8a4e-4b24-99c2-0d768e617e71&page=0&size=5"

[ ] 3.2. Check recommend-service logs cho scores:
        docker-compose logs recommend-service | Select-String "PostID.*score:"
        
        âœ… GOOD: Scores KHÃC NHAU
        [ 1] 69379a30... -> score: 0.6543
        [ 2] 6937b6b1... -> score: 0.5234
        [ 3] 6937c00b... -> score: 0.4567
        
        âŒ BAD: Scores GIá»NG NHAU (cáº§n debug thÃªm)
        [ 1] postId1 -> score: 0.3000
        [ 2] postId2 -> score: 0.3000
        [ 3] postId3 -> score: 0.3000

[ ] 3.3. Check Python logs cho score details:
        docker-compose logs recommend-service | Select-String "Post.*scores:"
        Expected: "Post X scores: content_sim=0.XXXX, implicit_fb=0.XXXX, ..."

BÆ¯á»šC 4: TEST USER ACTION FLOW (3 phÃºt)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[ ] 4.1. Má»Ÿ browser: http://localhost:3000

[ ] 4.2. Login vá»›i tÃ i khoáº£n

[ ] 4.3. LIKE má»™t bÃ i post

[ ] 4.4. Check post-service published event:
        docker-compose logs post-service | Select-String "Published user_action" | Select-Object -Last 5
        Expected: "ğŸ“¤ Published user_action event: LIKE by user ... on post ..."

[ ] 4.5. Check recommend-service received event:
        docker-compose logs recommend-service | Select-String "Received user_action" | Select-Object -Last 5
        Expected: "ğŸ“¥ Received user_action: LIKE by user ... on post ..."

[ ] 4.6. Check feedback was saved:
        docker-compose logs recommend-service | Select-String "Saved user feedback" | Select-Object -Last 5
        Expected: "ğŸ’¾ Saved user feedback: ... -> ... (type: LIKE, value: 1.0)"

[ ] 4.7. Check engagement was updated:
        docker-compose logs recommend-service | Select-String "Updated engagement" | Select-Object -Last 5
        Expected: "ğŸ“Š Updated engagement for post ...: likes=X, comments=Y, ..."

[ ] 4.8. Check cache was invalidated:
        docker-compose logs recommend-service | Select-String "Invalidated cache" | Select-Object -Last 5
        Expected: "ğŸ—‘ï¸ Invalidated cache for user: ..."

BÆ¯á»šC 5: VERIFY DATABASE (2 phÃºt)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[ ] 5.1. Connect to PostgreSQL:
        docker exec -it ctu-connect-postgres psql -U postgres -d ctu_connect_recommendation

[ ] 5.2. Check user_feedback table:
        SELECT user_id, post_id, feedback_type, feedback_value, created_at 
        FROM user_feedback 
        ORDER BY created_at DESC 
        LIMIT 5;
        
        Expected: PHáº¢I cÃ³ rows náº¿u Ä‘Ã£ like posts á»Ÿ bÆ°á»›c 4

[ ] 5.3. Check post_embeddings engagement:
        SELECT post_id, like_count, comment_count, popularity_score, updated_at 
        FROM post_embeddings 
        ORDER BY updated_at DESC 
        LIMIT 5;
        
        Expected: like_count PHáº¢I tÄƒng cho post Ä‘Ã£ like

[ ] 5.4. Exit PostgreSQL: \q

BÆ¯á»šC 6: TEST CACHE INVALIDATION (2 phÃºt)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[ ] 6.1. Get feed láº§n 1 (sáº½ cache results)

[ ] 6.2. Check logs: "Cached recommendations for user"

[ ] 6.3. LIKE má»™t post khÃ¡c

[ ] 6.4. Check logs: "Invalidated cache for user"

[ ] 6.5. Get feed láº§n 2 (KHÃ”NG nÃªn tá»« cache)

[ ] 6.6. Check logs: KHÃ”NG tháº¥y "Returning cached feed"
        Thay vÃ o Ä‘Ã³ pháº£i tháº¥y: "Prediction request for user"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Tá»”NG Káº¾T Káº¾T QUáº¢
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CRITICAL TESTS (PHáº¢I PASS):
[ ] Services start successfully
[ ] No bean definition errors
[ ] Scores are diverse (not all 0.3000)
[ ] User actions published from post-service
[ ] User actions received by recommend-service

IMPORTANT TESTS (NÃŠN PASS):
[ ] user_feedback table has data
[ ] post_embeddings engagement updated
[ ] Cache invalidation working
[ ] Python logs show score details

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  TROUBLESHOOTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Náº¾U SCORES VáºªN GIá»NG NHAU (0.3000):
1. Check Python logs: docker-compose logs recommend-service | Select-String "ERROR"
2. Náº¿u tháº¥y lá»—i â†’ Rebuild: docker-compose build recommend-service --no-cache
3. Restart: docker-compose restart recommend-service

Náº¾U USER ACTIONS KHÃ”NG NHáº¬N ÄÆ¯á»¢C:
1. Check Kafka: docker exec -it ctu-connect-kafka kafka-console-consumer --bootstrap-server localhost:9092 --topic user_action --from-beginning --max-messages 1
2. Náº¿u khÃ´ng cÃ³ message â†’ Post-service issue
3. Náº¿u cÃ³ message â†’ Recommend-service consumer issue
4. Restart both: docker-compose restart post-service recommend-service

Náº¾U BEAN DEFINITION ERROR:
1. Verify fix: Get-Content "recommend-service\java-api\src\main\java\vn\ctu\edu\recommend\config\KafkaConfig.java" | Select-String "userActionConsumerFactory"
2. MUST: No matches
3. If matches found â†’ Manually remove duplicate bean
4. Rebuild: docker-compose build recommend-service

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  AUTOMATED TEST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Thay vÃ¬ lÃ m thá»§ cÃ´ng, cÃ³ thá»ƒ cháº¡y automated test:

    .\test-fix.ps1

Script sáº½ tá»± Ä‘á»™ng check táº¥t cáº£ cÃ¡c Ä‘iá»ƒm trÃªn.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  TÃ€I LIá»†U THAM KHáº¢O
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

- FINAL-FIX-SUMMARY-DEC-9.md     : Chi tiáº¿t ká»¹ thuáº­t Ä‘áº§y Ä‘á»§
- QUICK-START-AFTER-FIX.md       : HÆ°á»›ng dáº«n quick start
- FIX-STATUS-REPORT.md           : BÃ¡o cÃ¡o status
- CRITICAL-FIXES-APPLIED.md      : Fixes trÆ°á»›c Ä‘Ã³

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Version: 1.0
Date: December 9, 2025
Status: âœ… READY FOR TESTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
